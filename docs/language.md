---
title: Язык
nav_order: 2
---

# Язык WinFlow

Короткое описание синтаксиса WinFlow, актуального в сборке.

## Файл скрипта
- Кодировка: UTF-8
- Расширение: `.wflow`

## Комментарии и пустые строки
- `// ...` или `# ...` — комментарии строки
- Пустые строки игнорируются

## Подстановки переменных
- Формат: `${NAME}` — подставляет значение переменной из контекста исполнения.
- Источники значений:
  - Явно установленные через `env set`
  - Значения, устанавливаемые командами (например, переменные циклов)
- Примеры:
  - `env set name=NAME value="World"`
  - `echo "Hello ${NAME}!"` → `Hello World!`
  - В циклах доступны: `${index}` и переменная элемента (см. ниже)

## Циклы
### loop.repeat
- Повторяет тело указанное число раз.
- Сигнатура: `loop repeat count=<N> body="<команда>"`
- Доступные переменные: `${index}` (0..N-1)
- Пример: `loop repeat count=3 body="echo pass ${index}"`

### loop.foreach
- Итерирует по списку элементов.
- Сигнатура: `loop foreach items="a,b,c" var=item sep="," body="echo ${item}"`
- Параметры:
  - `items` — строка со списком элементов
  - `sep` — разделитель (по умолчанию `,`)
  - `var` — имя переменной для элемента (по умолчанию `item`)
- Доступные переменные: `${index}`, `${<var>}`
- Пример: `loop foreach items="x;y;z" sep=";" var=name body="echo ${index}:${name}"`

Примечание: `body` — однострочная команда. Для более сложной логики используйте несколько циклов или выносите команды в отдельный скрипт.

## Команды (обзор)
- Базовые: `echo`, `noop`
- Env: `env set`, `env unset`, `env print`
- File: `file write`, `file append`, `file mkdir`, `file delete`, `file copy`
- Process: `process run`, `process exec`
- Registry (Windows): `reg set`, `reg get`, `reg delete`
- Sleep: `sleep ms`, `sleep sec`
- Net: `net download`
- Loop: `loop repeat`, `loop foreach`

Подробные сигнатуры см. в справочнике команд.

## Модель исполнения
- Все команды файла объединяются в один `Task` с именем файла (без расширения)
- Внутри один `Step`, команды исполняются сверху вниз
- Режим `--dry-run` печатает команды без выполнения

## Ошибки парсинга
- Неизвестная команда → ошибка с номером строки
- Базовая валидация обязательных аргументов

---

# План расширения синтаксиса
- Секции `task`/`step` и запуск по имени задачи
- Условия (`if`), включения (`include`)
- Многострочные блоки для тел циклов
